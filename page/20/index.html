<!DOCTYPE html>
<html lang="en-us">
    
<head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.49" />

    

<title>Midnight Programmer</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Midnight Programmer"/>
<meta name="twitter:description" content="Programming For Fun"/>

<meta property="og:title" content="Midnight Programmer" />
<meta property="og:description" content="Programming For Fun" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://prashantkhandelwal.github.io/" />
<meta property="og:updated_time" content="2011-01-25T16:12:00&#43;00:00"/><meta property="og:site_name" content="Midnight Programmer" />


    


<link rel="stylesheet" href="/css/hyde-hyde.css">
<link rel="stylesheet" href="/css/print.css" media="print">


    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

<link href="https://prashantkhandelwal.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Midnight Programmer" />
<link href="https://prashantkhandelwal.github.io/index.xml" rel="feed" type="application/rss+xml" title="Midnight Programmer" />


</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://prashantkhandelwal.github.io/">Midnight Programmer</a>
      </span>
      
      
      
      <div class="author-image">
        <img src="https://prashantkhandelwal.github.io//img/prashantk.jpg" alt="Author Image" class="img--circle img--headshot element--center"> 
      </div>
      
      <p class="site__description">
         Programming For Fun 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Midnight Programmer</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/archive/"><i class='fa fa-road'></i>
						<span>Archive</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/top-posts/"><i class='fa fa-star fa-fw'></i>
						<span>Top Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/contact/"><i class='fa fa-envelope fa-fw'></i>
						<span>Contact</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/nullgap" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/khandelwal.p" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/prashantkhandelwal" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="http://feeds.feedburner.com/MidnightProgrammer" rel="me"><i class="fa fa-rss fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="https://instagram.com/prashantkhandelwal" rel="me"><i class="fab fa-instagram fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://linkedin.com/in/khandelwalprashant" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://medium.com/@prashantkhandelwal" rel="me"><i class="fab fa-medium fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
</section>

      </div>
    </div>
    <p class="copyright">
      &copy; 2023 Pashant Khandelwal
      <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/2.5/in/"><img style="border-width: 0;" src="https://i.creativecommons.org/l/by-nc-sa/2.5/in/88x31.png" alt="Creative Commons License" class="thinglinkFiltered"></a>
      
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            
<div class="post-list">
  
  
  <div class="post-list__item">
    <span class="item__title--big">
      <a href="/post/code-snippet-export-datagridview-to-excel-with-columns/">Code Snippet: Export DataGridView To Excel With Columns</a>
      
    </span>
    <span class="item__date">
      <i class="fas fa-calendar-alt"></i> Jan 25, 2011
    </span>
    
    <span>
      
      
      
      
      
      
      <a class="badge badge-category" href="/category/c">C#</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/code-snippets">CODE SNIPPETS</a>
      
      
      
      
    </span>
    <p>This is among one of the best code snippet I have and using since long to export the datagridview to excel. The best part of this code snippet is that it just don&rsquo;t uses the excel interop, so you need not to worry about the Office version or PIAs installed at user&rsquo;s machine. What actualy is needed is just a Reflection namespace - <code>System.Reflection</code> and it will bind the data to the instance of the excel application.</p>

<pre class="brush:csharp">
private void Export2Excel(DataGridView datagridview, bool captions)
{
    if (datagridview.ColumnCount > 0)
    {
        string[] strArray = new string[datagridview.ColumnCount];
        string[] strArray2 = new string[datagridview.ColumnCount];
        int num = 0;
        int index = 0;
        int num3 = 0;
        for (index = 0; index < datagridview.ColumnCount; index++)
        {
            strArray[index] = datagridview.Rows[0].Cells[index].OwningColumn.Name.ToString();
            if ((num > 0) && ((index % num) == 0))
            {
                num = 0;
            }
            num3 = index / 0x1a;
            if (num3 == 0)
            {
                num = index + 0x41;
                strArray2[index] = Convert.ToString((char)num);
            }
            else
            {
                int num4 = num3 + 0x40;
                num = (index % 0x1a) + 0x41;
                strArray2[index] = Convert.ToString((char)num4) + Convert.ToString((char)num);
            }
        }
        try
        {
            object obj7;
            object target = Activator.CreateInstance(Type.GetTypeFromProgID("Excel.Application"));
            object obj4 = target.GetType().InvokeMember("Workbooks", BindingFlags.GetProperty, null, target, null);
            object obj3 = obj4.GetType().InvokeMember("Add", BindingFlags.InvokeMethod, null, obj4, null);
            object obj5 = obj3.GetType().InvokeMember("Worksheets", BindingFlags.GetProperty, null, obj3, null);
            object[] args = new object[] { 1 };
            object obj6 = obj5.GetType().InvokeMember("Item", BindingFlags.GetProperty, null, obj5, args);
            if (captions)
            {
                index = 0;
                while (index < datagridview.ColumnCount)
                {
                    args = new object[] { strArray2[index] + "1", Missing.Value };
                    obj7 = obj6.GetType().InvokeMember("Range", BindingFlags.GetProperty, null, obj6, args);
                    args = new object[] { strArray[index] };
                    obj7.GetType().InvokeMember("Value", BindingFlags.SetProperty, null, obj7, args);
                    index++;
                }
            }
            for (num = 0; num < datagridview.RowCount; num++)
            {
                for (index = 0; index < datagridview.ColumnCount; index++)
                {
                    args = new object[] { strArray2[index] + Convert.ToString((int)(num + 2)), Missing.Value };
                    obj7 = obj6.GetType().InvokeMember("Range", BindingFlags.GetProperty, null, obj6, args);
                    args = new object[] { datagridview.Rows[num].Cells[strArray[index]].Value.ToString() };
                    obj7.GetType().InvokeMember("Value", BindingFlags.SetProperty, null, obj7, args);
                }
            }
            args = new object[] { true };
            target.GetType().InvokeMember("Visible", BindingFlags.SetProperty, null, target, args);
            target.GetType().InvokeMember("UserControl", BindingFlags.SetProperty, null, target, args);
        }
        catch (Exception exception)
        {
            MessageBox.Show(("Error: " + exception.Message) + " Line: " + exception.Source, "Error");
        }
      }
    }
</pre>

  </div>
  
  <div class="post-list__item">
    <span class="item__title--big">
      <a href="/post/windows-7-development-working-with-task-dialog-class/">Windows 7 Development: Working With Task Dialog Class</a>
      
    </span>
    <span class="item__date">
      <i class="fas fa-calendar-alt"></i> Jan 24, 2011
    </span>
    
    <span>
      
      
      
      
      
      
      <a class="badge badge-category" href="/category/api">API</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/c">C#</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/windows">WINDOWS</a>
      
      
      
      
    </span>
    <p>Last year, I blogged about few things related to <a href="http://midnightprogrammer.net/category/Windows">Windows 7 development</a> which includes <a href="http://midnightprogrammer.net/post/windows-7-create-jumplists-in-wpf-application-without-using-windows-7-api-code-pack">Jump Lists</a> and <a href="http://midnightprogrammer.net/post/windows-7-development-aero-effects-in-net-applications">Glass Form</a>. The Windows 7 API Code Pack comes with many other features which can be used while developing applications for Windows 7 platform. The <a href="http://code.msdn.microsoft.com/WindowsAPICodePack">Windows 7 API Code Pack</a> comes with some sample applications which exposes the power of the API.</p>

<p>In one of my previous projects I used the Task Dialog class to use some cool looking message boxes like the one we see in Windows 7. If you see the sample code and and the executable, they are working fine but when you write the same code in the code in your application, this will not turn out to be as you would have expected. You will see a runtime error as the one below.</p>

<p><img src="/images/win7dev-exception.png" alt="Windows 7 API exception" /></p>

<p>This problem can be resolved by adding a <code>app.manifest</code> file to your project and modifying some part of it. Move to the end of the file and un-comment the <code>&amp;lt;dependency&amp;gt;</code> section of the file.</p>

<pre class="brush:xml">
&lt;dependency&gt;
    &lt;dependentAssembly&gt;
      &lt;assemblyIdentity
          type="win32"
          name="Microsoft.Windows.Common-Controls"
          version="6.0.0.0"
          processorArchitecture="*"
          publicKeyToken="6595b64144ccf1df"
          language="*"
        /&gt;
    &lt;/dependentAssembly&gt;
&lt;/dependency&gt;
</pre>

<p>Hit <code>F5</code> again and this will do the trick for you, this time you will be able to view the message box as you wanted to. The API sample contains code for all the possible / available task dialog for you to use. But the usage is bit difficult as this cannot be acaieved in a single line like we do with the MessageBox class. Therefore I suggest you to build a helper class / function to get this easy for you. As I used this in one of my projects I have two functions one for showing the information and error messages respectively. You can also have a overload method for this, but as I have used different method names instead as I will be using only two dialogs throughout my project.</p>

<p><strong>For Error Messages:</strong></p>

<pre class="brush:csharp">
public static void ShowErrorMessage(string ErrorTitle, string Instruction, string ErrorMessage, string ErrorTrace)
{
            TaskDialog tdError;
            tdError = new TaskDialog();
            tdError.DetailsExpanded = false;
            tdError.Cancelable = true;
            tdError.Icon = TaskDialogStandardIcon.Error;
 
            tdError.Caption = ErrorTitle;
            tdError.InstructionText = Instruction;
            tdError.Text = ErrorMessage;
            tdError.DetailsExpandedLabel = "Hide details";
            tdError.DetailsCollapsedLabel = "Show details";
            tdError.DetailsExpandedText = ErrorTrace;
 
            tdError.Show();
}
</pre>

<p>All the properties in the above function is self-explainatory. The code at line:12 will have a expander in the dialog box which will contain more details of the exception.</p>

<p>Function for showing information is also the same but with few things &ldquo;missing&rdquo;:</p>

<pre class="brush:csharp">
public static void ShowInfoMessage(string InfoTitle, string Information, string Message)
{
            TaskDialog tdInfo;
            tdInfo = new TaskDialog();
            tdInfo.DetailsExpanded = false;
            tdInfo.Cancelable = true;
            tdInfo.Icon = TaskDialogStandardIcon.Information;
 
            tdInfo.Caption = InfoTitle;
            tdInfo.InstructionText = Information;
            tdInfo.Text = Message;
            tdInfo.Show();
}
</pre>

<p><strong>Sample Usage:</strong></p>

<pre class="brush:csharp">
//For Error Dialog
ShowErrorMessage("Application Error", "There was an error in creating XML file", ex.Message, ex.StackTrace);
 
//For Information Dialog
ShowInfoMessage("Application Name", "Image more than 32x32 pixels will be rejected", "Please check the image pixel before you use choose a package icon");
</pre>

<p><strong>Error Dialog Box</strong></p>

<p><img src="/images/win7-errordialog.png" alt="Windows 7 API error message dialog box" /></p>

<p>Click the <code>Show Details</code> expander icon to view the complete error stack trace.</p>

<p><strong>Information Dialog Box</strong></p>

<p><img src="/images/win7-infodialog.png" alt="Windows 7 API information dialog box" /></p>

<p>This is just the two types of dialogs I have used for my project, but there are more supported in the API. So to get started see the sample project accompanying the API Code Pack including the one you see while running programs as Administrator while UAC is turned on, a dialog box with a progress bar and lots of more to check. The samples above would get you started.</p>

<p>If you are a Visual Studio 2010 user with NuGet installed, then you can add the API reference to your project with the below command.</p>

<pre class="brush:shell">
Install-Package Windows7APICodePack
</pre>

  </div>
  
  <div class="post-list__item">
    <span class="item__title--big">
      <a href="/post/using-jquery-to-get-your-tweets/">Using jQuery To Get Your Tweets</a>
      
    </span>
    <span class="item__date">
      <i class="fas fa-calendar-alt"></i> Dec 27, 2010
    </span>
    
    <span>
      
      
      
      
      
      
      <a class="badge badge-category" href="/category/api">API</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/jquery">JQUERY</a>
      
      
      
      
    </span>
    <p><img align="right" src="/images/tweet.png" alt="Twitter bird"/></p>

<p>If you are a blogger and using Twitter, then you must want to show some of your latest tweets on your blog space. I do have a custom widget for my blog which can display 3 of my latest tweets and I can customize it show more of my tweets. But the widgets cannot be used in every scenario and this is why some people find it difficult to use the widget provided by Twitter to display their tweets. What if they want to show their last tweet on the top of the page inside a DIV? A friend of mine set up his new WordPress blog and want to have a DIV on the top of the page which displays his last post and that he can customize. By customize I mean that he can set the number of tweets he wants to display, can show his profile picture and get his last tweet. The script file contains only three methods at this moment. I will add some other functions later on.</p>

<p><strong>How does this work?</strong></p>

<p>It is just a javascript file and there is nothing new about it. What you need to do is to have a DIV or any HTML element or ASP.NET server control with id as <code>'tweet-div'</code>. For this example I am using a DIV to show my tweets. I choose DIV because I can set it position to absolute and set on the image to show my latest tweet on an image I got from <a href="http://www.iconfinder.com/">Iconsinder</a>. It is a pretty twitter imageand there are other images also which you can use, but for non-commercial purpose only. First, take a look at the jQuery script I wrote to do all the stuff:</p>

<pre class="brush:jscript">
function GetLastTweet(UserName) {
    url = 'http://api.twitter.com/1/statuses/user_timeline/' + UserName + '.json?callback=?';
    $.getJSON(url, function (tweet) {
        $("#tweet-div").html(tweet[0].text);
    });
}
 
function GetTweets(UserName, NoOfTweets) {
    url = 'http://api.twitter.com/1/statuses/user_timeline/' + UserName + '.json?callback=?';
    $.getJSON(url, function (tweets) {
        for (var i = 0; i < NoOfTweets; i++) {
            $("#tweet-div").append(tweets[i].text + "<br/>");
        }
    });
}
 
function GetProfileImage(UserName) {
    url = 'http://api.twitter.com/1/statuses/user_timeline/' + UserName + '.json?callback=?';
    $.getJSON(url, function (image) {
        $("#ProfileImage").attr('src', image[0].user.profile_image_url);
    });
}
</pre>

<p>To communicate with the Twitter API, I am using JSON. Plan to go for XML only if you are using it on the server side code. As you can see it is pretty easy to work with JSON in jQuery. The methods:</p>

<ul>
<li><strong>GetLastTweet(UserName)</strong> will get the last tweet of any user. Pass the twitter user name as a parameter.</li>
<li><strong>GetTweets(UserName, NoOfTweets)</strong> will get the specified number of tweets for the user. the first parameter will be the twitter user name and the second parameter will be the number of tweets you want to display.</li>
<li><strong>GetProfileImage(UserName)</strong> will get the profle image of the user.</li>
</ul>

<p>*<strong>Note:</strong> Please change the element <strong>ID</strong> in the script file according to your element id on the page.*</p>

<p>And just in case if you are feeling lazy to write the the HTML markup:</p>

<pre class="brush:html">
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
    &lt;title&gt;@prashantmx on Twitter!&lt;/title&gt;
    &lt;script src="Scripts/jquery-1.4.1.js" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="Scripts/Tweet.js" type="text/javascript"&gt;&lt;/script&gt;
    &lt;link href="style/style.css" rel="stylesheet" type="text/css" /&gt;
&lt;/head&gt;
&lt;body onload="GetLastTweet('prashantmx');"&gt;
&lt;img src="images/1293447412_bird_sign.png" alt="twitterbird" /&gt;
&lt;div id ="tweet-div"&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>I am using an image of twitter bird to show my last tweet. And here is what my last tweet looks like:</p>

<p>If you want to use the below image or other images like this then go to Iconfinder. There is a good collection of twitter birds images as shown below and choose which best suites your requirement.</p>

<p><img src="/images/tweet-display.png" alt="Tweet displayed on page" /></p>

<p><strong>Download: <a href="/files/Twitter.zip">Twitter.zip (159.92 kb)</a></strong></p>

  </div>
  
  <div class="post-list__item">
    <span class="item__title--big">
      <a href="/post/adding-captcha-in-aspnet-application/">Adding CAPTCHA In ASP.NET Application</a>
      
    </span>
    <span class="item__date">
      <i class="fas fa-calendar-alt"></i> Dec 26, 2010
    </span>
    
    <span>
      
      
      
      
      
      
      <a class="badge badge-category" href="/category/api">API</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/asp.net">ASP.NET</a>
      
      
      
      
    </span>
    <p><img align="right" src="/images/recaptcha.png" alt="recaptcha"/></p>

<p>Using CAPTCHA was never easy for me before I got a class from an unknown user on a community forum post. I have just re-used the class to get my work done. The class is extremely easy to use and let you incorporate the CAPTCHA into your application in just few lines of code.</p>

<p>You can set the height and width of the CAPTCHA image while initializing the CAPTCHA class. The CAPTCHA image generated from the class can be set to the image control directly or it can be save to the local path and then set to the image control. For this example I am saving it to the local path and then set to the image control. And the CAPTCHA image code generated by the class is automatically set to the session variable named <code>CaptchaCode</code>.</p>

<p><strong>Time to get some hand on it</strong></p>

<p>On the page get an image control to display CAPTCHA image, a textbox where user will enter the CAPTCHA text and a button when clicked, we can check and validate if the code entered is correct or not. Plug the DLL in your ASP.NET project and go to the <code>Page_Load</code> event. Here we will generate the image of the height and width we wish to have for out CAPTCHA image and then save the image to the <code>CaptchaImages</code> folder with the random image code generated. The code on the <code>Page_Load</code> event goes like this:</p>

<pre class="brush:csharp">
protected void Page_Load(object sender, EventArgs e)
{
        if (!Page.IsPostBack)
        {
            CaptchaImage cImage = new CaptchaImage(CaptchaImage.generateRandomCode(), 140, 40);
            cImage.Image.Save(Server.MapPath("~\\CaptchaImages\\" + Convert.ToString(Session["CaptchaCode"]) + ".jpg"), ImageFormat.Jpeg);
            CaptachaImage.ImageUrl = "~\\CaptchaImages\\" + Convert.ToString(Session["CaptchaCode"]) + ".jpg";
            cImage.Dispose();
        }
        CaptchaCode = Convert.ToString(Session["CaptchaCode"]);
}
</pre>

<p>Before you can use the above code, declare a public variable which I have used to hold the value of the CAPTCHA code. I named it <code>CaptchaCode</code>. You can name it whatever you like it. We will be using this variable later to check it against the user input. Hit <code>F5</code> to start and test your application. If everything is in place and you will be able to see the below output.</p>

<p><img src="/images/recaptcha-render.png" alt="Recaptcha render" /></p>

<p>To check if the user enters the correct CAPTCHA code, we must have an event on button click which will validate the user input and prompt the user if CAPTCHA code is correct or incorrect. The code on the button click is:</p>

<pre class="brush:csharp">
protected void btn_Validate(object sender, EventArgs e)
{
        if (CaptchaCode == txt_ccode.Text)
        {
            ClientScript.RegisterClientScriptBlock(typeof(Page), "ValidateMsg", "&lt;script&gt;alert('You entered Correct CAPTCHA Code!');&lt;/script&gt;");
        }
        else
        {
            ClientScript.RegisterClientScriptBlock(typeof(Page), "ValidateMsg", "&lt;script&gt;alert('You entered INCORRECT CAPTCHA Code!');&lt;/script&gt;");
        }
}
</pre>

<p>The above code will check the CAPTCHA code entered by the user and check against the CAPTCHA code we previously saved in the session variable (<code>CaptchaCode</code>). If the validation is a success, user will get the message notifying him that he enters correct CAPTCHA code or the error message otherwise.</p>

<p>And that&rsquo;s it, we have successfully implement a CAPTCHA in our ASP.NET application. So, here are few things we can do with this CAPTCHA library:</p>

<ul>
<li>Set image height and width.</li>
<li>Saves the image to the local path.</li>
<li>Automatically sets the generated CAPTCHA code to the application session.</li>
</ul>

<p>I have build the sample project in ASP.NET 4.0, if you wanted to use the library in ASP.NET 3.x, then compile the project with lower version of ASP.NET and it will work perfectly. The below zip file contains both the projects.</p>

<p><strong>Download: <a href="/files/Captcha.NET.zip">Captcha.NET.zip (377.63 kb)</a></strong></p>

  </div>
  
  <div class="post-list__item">
    <span class="item__title--big">
      <a href="/post/autocomplete-with-jquery-and-aspnet/">Autocomplete With jQuery and ASP.NET</a>
      
    </span>
    <span class="item__date">
      <i class="fas fa-calendar-alt"></i> Dec 19, 2010
    </span>
    
    <span>
      
      
      
      
      
      
      <a class="badge badge-category" href="/category/asp.net">ASP.NET</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/c">C#</a>
      &nbsp;
      
      <a class="badge badge-category" href="/category/jquery">JQUERY</a>
      
      
      
      
    </span>
    <p>Building auto-complete feature with jQuery is easy and you can build this in no time. It&rsquo;s your wish if you want to use ADO.NET or EF (LINQ) to get this done, it works great for all. The sample application I build is using both ADO.NET and EF. So let&rsquo;s begin up getting files under one hood.</p>

<p>Use the below live links for jQuery auto-complete and CSS.</p>

<pre class="brush:html">
&lt;link rel="stylesheet" href="http://dev.jquery.com/view/trunk/plugins/autocomplete/jquery.autocomplete.css" type="text/css" /&gt;
&lt;script type="text/javascript" src="http://dev.jquery.com/view/trunk/plugins/autocomplete/jquery.autocomplete.js"&gt;&lt;/script&gt;
</pre>

<p>You can also download these files and use them in your project, if you are planning to run your application offline. For this demonstration, I have downloaded the files. I am using both ADO.NET and LINQ to auto-complete with jQuery auto-complete pug-in.</p>

<p>Starting up with ADO.NET, as we were/are using this for so many years now and therefore there should be no problem for anyone using it. Simple page behind code to get the full list of countries in the world (I hope I have all of them) and seperate each country name with a &lsquo;|&rsquo; pipe symbol so I can split countries name and set it to the text box for auto-complete.</p>

<pre class="brush:csharp">
public partial class _Default : System.Web.UI.Page
   {
       SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["constr"].ConnectionString);
       SqlCommand cmd;
       SqlDataReader dr;
 
       public string Listcountries;
 
       private string countryName()
       {
 
           StringBuilder sb = new StringBuilder();
           cmd = new SqlCommand("Select country_name from Country order by country_name", con);
           con.Open();
           dr = cmd.ExecuteReader();
 
           while (dr.Read())
           {
               sb.Append(Convert.ToString(dr[0] + "|"));
           }
 
           return Convert.ToString(sb);
       }
 
       protected void Page_Load(object sender, EventArgs e)
       {
           Listcountries = countryName();
       }
   }
</pre>

<p>Done with code behind and now only requires few lines of client script on the page to get the auto-complete running.</p>

<pre class="brush:jscript">
&lt;script type="text/javascript"&gt;
        $(document).ready(function () {
            var cc = '&lt;%=Listcountries%&gt;'.split("|");
            $("#autoText").autocomplete(cc);
        });
&lt;/script&gt;
</pre>

<p>The same can be done with LINQ but the jQuery script part will be the same.</p>

<pre class="brush:csharp">
public partial class AutocompleteLINQ : System.Web.UI.Page
{
    DeveloperDBEntities db = new DeveloperDBEntities();
    public IQueryable countries;
    public string Listcountries;

    protected void Page_Load(object sender, EventArgs e)
    {
        countries = from c in db.Countries select c;
        foreach (Country cobj in countries)
        {
            Listcountries += cobj.Country_Name + "|";
        }
    }
}
</pre>

<p>Just for your ease to use this project as it is, I have included the SQL scripts for the country table. Hope this helps you in building another great or a part of your application.</p>

<p><strong>Download: <a href="/files/JqueryAutoComplete.zip">JqueryAutoComplete.zip (210.73 kb)</a></strong></p>

  </div>
  
</div>


<ul class="pagination">
    
    <li class="page-item">
        <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/page/19/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/19/">19</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/page/20/">20</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/21/">21</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/33/">33</a></li>
    
    
    <li class="page-item">
    <a href="/page/21/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/page/33/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>


        </div>
        



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-QYXJT2TJCG', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"
  integrity="sha384-4oV5EgaV02iISL2ban6c/RmotsABqE4yZxZLcYMAdG7FAPsyHYAPpywE9PJo+Khy"
  crossorigin="anonymous">
</script>

<link
  href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeDefault.min.css"
  rel="stylesheet"
/>

<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCSharp.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCss.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPlain.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushSql.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPowerShell.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPython.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushBash.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCpp.min.js"
></script>
<script
  type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushRuby.min.js"
></script>

<script>
  SyntaxHighlighter.defaults["gutter"] = true;
  SyntaxHighlighter.defaults["smart-tabs"] = true;
  SyntaxHighlighter.defaults["auto-links"] = true;
  SyntaxHighlighter.defaults["collapse"] = false;
  SyntaxHighlighter.defaults["light"] = false;
  SyntaxHighlighter.defaults["tab-size"] = 4;
  SyntaxHighlighter.defaults["toolbar"] = false;
  SyntaxHighlighter.defaults["wrap-lines"] = true;
  SyntaxHighlighter.all();
</script>


    </body>
</html>
